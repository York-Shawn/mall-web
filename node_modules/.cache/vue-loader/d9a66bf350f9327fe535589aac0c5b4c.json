{"remainingRequest":"D:\\go-workspace\\mall\\web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\go-workspace\\mall\\web\\src\\view\\Category.vue?vue&type=style&index=0&id=ed440b82&scoped=true&lang=css","dependencies":[{"path":"D:\\go-workspace\\mall\\web\\src\\view\\Category.vue","mtime":1677664148717},{"path":"D:\\go-workspace\\mall\\web\\node_modules\\css-loader\\dist\\cjs.js","mtime":1678869285258},{"path":"D:\\go-workspace\\mall\\web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1678869302587},{"path":"D:\\go-workspace\\mall\\web\\node_modules\\postcss-loader\\src\\index.js","mtime":1678869286413},{"path":"D:\\go-workspace\\mall\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678869284518},{"path":"D:\\go-workspace\\mall\\web\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1678869302535}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouZWwtZGlhbG9nIHsNCiAgaGVpZ2h0OiAyMDBweCAhaW1wb3J0YW50Ow0KICBvdmVyZmxvdy15OiBzY3JvbGw7DQp9DQo="},{"version":3,"sources":["D:\\go-workspace\\mall\\web\\src\\view\\Category.vue"],"names":[],"mappings":";AAiSA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACT,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACxB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACpB","file":"D:/go-workspace/mall/web/src/view/Category.vue","sourceRoot":"","sourcesContent":["<template>\r\n  <container>\r\n    <!-- 商品查询 -->\r\n    <el-form :inline=\"true\" :model=\"query\" ref=\"query\" class=\"goods_query_form\">\r\n      <el-form-item prop=\"name\">\r\n        <el-input v-model.number=\"query.name\" placeholder=\"类目名称\"/>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" :icon=\"Search\" @click=\"getCategoryList\">查询</el-button>\r\n        <el-button type=\"primary\" @click=\"addLv1Category\">添加一级类目</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    <!-- 商品一级类目列表 -->\r\n    <el-table :data=\"categoryLv1List\" height=\"65vh\" style=\"width: 100%\">\r\n      <el-table-column prop=\"id\" label=\"编号\"/>\r\n      <el-table-column prop=\"name\" label=\"名称\"/>\r\n      <el-table-column prop=\"level\" label=\"级别\"/>\r\n      <el-table-column prop=\"sort\" label=\"排序\"/>\r\n      <el-table-column label=\"操作\" min-width=\"130\">\r\n        <template #default=\"scope\">\r\n          <el-button size=\"small\" type=\"primary\" :icon=\"Edit\" @click=\"editLv1Category(scope.row)\"/>\r\n          <el-button size=\"small\" type=\"primary\" :icon=\"Plus\" @click=\"addLv2Category(scope.row)\"/>\r\n          <el-button size=\"small\" type=\"primary\" @click=\"checkLv2Category(scope.row)\">查看二级类目</el-button>\r\n          <el-popconfirm title=\"此操作将永久删除该信息, 是否继续?\"\r\n                         confirmButtonText=\"确认\"\r\n                         cancelButtonText=\"取消\"\r\n                         cancelButtonType=\"default\"\r\n                         :icon=\"WarningFilled\"\r\n                         @confirm=\"deleteCategory(scope.row)\">\r\n            <template #reference>\r\n             <el-button size=\"small\" type=\"danger\" :icon=\"Delete\"/>\r\n            </template>\r\n          </el-popconfirm>\r\n        </template>\r\n      </el-table-column>\r\n      <template #empty>\r\n        <div style=\"margin: 50px 0;\">\r\n          <el-empty v-if=\"showEmpty\" description=\"暂时还没有商品哦\" />\r\n        </div>\r\n      </template>\r\n    </el-table>\r\n    <div style=\"padding: 10px 0;\">\r\n      <el-pagination layout=\"total, prev, pager, next\"\r\n                   :current-page=\"pageNum\"\r\n                   :page-size=\"pageSize\"\r\n                   :total=\"total\"\r\n                   @current-change=\"handleCurrentChange\"\r\n                   @prev-click=\"handleCurrentChangePrev\"\r\n                   @next-click=\"handleCurrentChangeNext\" background/>\r\n    </div>\r\n    <!-- 添加、编辑商品，通用对话框 -->\r\n    <el-dialog :title=\"dialogTitle\" v-model=\"categoryDialogVisible\" top=\"30vh\" width=\"35%\" @close=\"cancelCategory\">\r\n      <el-form :model=\"category\" label-width=\"50px\" style=\"padding: 10px;\">\r\n        <el-form-item label=\"名称\">\r\n          <el-input v-model=\"category.name\" type=\"text\" maxlength=\"10\" show-word-limit/>\r\n        </el-form-item>\r\n        <el-form-item label=\"排序\">\r\n          <el-input v-model.number=\"category.sort\" />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"cancelCategory\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"confirmCategory\">确定</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n    <!-- 查看二级类目列表，对话框 -->\r\n    <el-dialog :title=\"dialogTitle\" v-model=\"checkLv2CategoryDialogVisible\" top=\"10vh\" width=\"50%\">\r\n      <el-table :data=\"categoryLv2List\" height=\"60vh\" style=\"width: 100%\">\r\n        <el-table-column prop=\"id\" label=\"编号\"/>\r\n        <el-table-column prop=\"name\" label=\"名称\"/>\r\n        <el-table-column prop=\"level\" label=\"级别\"/>\r\n        <el-table-column prop=\"sort\" label=\"排序\"/>\r\n        <el-table-column label=\"操作\" min-width=\"130\">\r\n          <template #default=\"scope\">\r\n            <el-button size=\"small\" type=\"primary\" :icon=\"Edit\" @click=\"editLv2Category(scope.row)\"/>\r\n            <el-popconfirm title=\"此操作将永久删除该信息, 是否继续?\"\r\n                         confirmButtonText=\"确认\"\r\n                         cancelButtonText=\"取消\"\r\n                         cancelButtonType=\"default\"\r\n                         :icon=\"WarningFilled\"\r\n                         @confirm=\"deleteCategory(scope.row)\">\r\n            <template #reference>\r\n             <el-button size=\"small\" type=\"danger\" :icon=\"Delete\"/>\r\n            </template>\r\n          </el-popconfirm>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-dialog>\r\n  </container>\r\n</template>\r\n\r\n<script>\r\nimport container from \"../components/container\";\r\nimport {Delete, Edit, Plus, Search, WarningFilled} from \"@element-plus/icons-vue\";\r\nimport {ElMessage} from \"element-plus\";\r\n\r\nexport default {\r\n  name: \"Category\",\r\n  components: {container},\r\n  setup() {\r\n    return {Search, Plus, Edit, Delete, WarningFilled}\r\n  },\r\n  data() {\r\n    return {\r\n      categoryLv1List: [],\r\n      categoryLv2List: [],\r\n      category: {\r\n        id: '',\r\n        name: '',\r\n        parentId: '',\r\n        level: '',\r\n        sort: ''\r\n      },\r\n      query: {\r\n        name: ''\r\n      },\r\n      dialogTitle: '',\r\n      operateType: '',\r\n      categoryDialogVisible: false,\r\n      checkLv2CategoryDialogVisible: false,\r\n\r\n      // 分页\r\n      total: 0,\r\n      pageNum: 1,\r\n      pageSize: 10,\r\n\r\n      // 空状态\r\n      showEmpty: false\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getCategoryList(1)\r\n  },\r\n  methods: {\r\n\r\n    // 分页，处理函数\r\n    handleCurrentChangePrev(val) {\r\n      this.pageNum = val;\r\n      console.log(`上一页: ${val}`);\r\n    },\r\n    handleCurrentChange(val) {\r\n      this.pageNum = val;\r\n      this.getCategoryList();\r\n      console.log(`当前页: ${val}`);\r\n    },\r\n    handleCurrentChangeNext(val) {\r\n      this.pageNum = val;\r\n      console.log(`下一页: ${val}`);\r\n    },\r\n\r\n    // 添加一级类目\r\n    addLv1Category(){\r\n      this.operateType = 'add'\r\n      this.dialogTitle = '添加一级类目'\r\n      this.category.level = 1\r\n      this.category.parentId = 1\r\n      this.categoryDialogVisible = true\r\n    },\r\n\r\n    // 编辑一级类目\r\n    editLv1Category(row){\r\n      this.operateType = 'edit'\r\n      this.dialogTitle = '编辑一级类目'\r\n      this.category.id = row.id\r\n      this.category.name = row.name\r\n      this.category.sort = row.sort\r\n      this.categoryDialogVisible = true\r\n    },\r\n\r\n    // 添加二级类目\r\n    addLv2Category(row){\r\n      this.operateType = 'add'\r\n      this.dialogTitle = '添加二级类目'\r\n      this.category.level = 2\r\n      this.category.parentId = row.id\r\n      this.categoryDialogVisible = true\r\n    },\r\n\r\n    // 编辑二级类目\r\n    editLv2Category(row){\r\n      this.operateType = 'edit'\r\n      this.dialogTitle = '编辑二级类目'\r\n      this.category.id = row.id\r\n      this.category.name = row.name\r\n      this.category.sort = row.sort\r\n      this.categoryDialogVisible = true\r\n    },\r\n\r\n    // 查看二级类目\r\n    checkLv2Category(row){\r\n      this.dialogTitle = '查看二级类目'\r\n      this.getCategoryList(row.id)\r\n      this.checkLv2CategoryDialogVisible = true\r\n    },\r\n\r\n    // 获取类目列表\r\n    getCategoryList(parentId){\r\n      this.$axios.get('/category/list', {\r\n        params: {\r\n          name: this.query.name,\r\n          parentId: parentId,\r\n          sid: localStorage.getItem('sid')\r\n        }\r\n      }).then((response) => {\r\n        if (parentId === 1){\r\n          this.categoryLv1List = response.data.data;\r\n        } else {\r\n          this.categoryLv2List = response.data.data;\r\n        }\r\n        if (this.categoryLv1List.length === 0) {\r\n          this.showEmpty = true\r\n        }\r\n      }).catch((error) => {\r\n        console.log(error)\r\n      })\r\n    },\r\n\r\n    // 确定添加、编辑类目\r\n    confirmCategory(){\r\n      if (this.operateType === 'add'){\r\n        this.$axios.post('/category/create', {\r\n          name: this.category.name,\r\n          parentId: this.category.parentId,\r\n          level: this.category.level,\r\n          sort: this.category.sort,\r\n          sid: localStorage.getItem('sid')\r\n        }).then((response) => {\r\n          if (response.data.code === 200) {\r\n            ElMessage({message: response.data.message, type: 'success'})\r\n          }\r\n          this.getCategoryList(1)\r\n        }).catch((error) => {\r\n          console.log(error)\r\n        })\r\n      }\r\n      if (this.operateType === 'edit'){\r\n        this.$axios.put('/category/update', {\r\n          id: this.category.id,\r\n          name: this.category.name,\r\n          sort: this.category.sort\r\n        }).then((response) => {\r\n          if (response.data.code === 200) {\r\n            ElMessage({message: response.data.message, type: 'success'})\r\n          }\r\n          this.getCategoryList(1)\r\n        }).catch((error) => {\r\n          console.log(error)\r\n        })\r\n      }\r\n      this.categoryDialogVisible = false\r\n      this.checkLv2CategoryDialogVisible = false\r\n    },\r\n    deleteCategory(row){\r\n      this.$axios.delete('/category/delete', {\r\n          params: {\r\n            id: row.id\r\n          }\r\n        }).then((response) => {\r\n          if (response.data.code === 200) {\r\n            ElMessage({message: response.data.message, type: 'success'})\r\n          }\r\n          this.getCategoryList(1)\r\n        }).catch((error) => {\r\n          console.log(error)\r\n      })\r\n    },\r\n    cancelCategory(){\r\n      this.categoryDialogVisible = false\r\n      this.emptyCategory()\r\n      this.dialogTitle = ''\r\n      this.operateType = ''\r\n    },\r\n\r\n    // 清空类目\r\n    emptyCategory(){\r\n      this.category.id = ''\r\n      this.category.name = ''\r\n      this.category.parentId = ''\r\n      this.category.level = ''\r\n      this.category.sort = ''\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.el-dialog {\r\n  height: 200px !important;\r\n  overflow-y: scroll;\r\n}\r\n</style>"]}]}